/*! For license information please see 946.deac1e5c.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkmeshtastic_admin_frontend=self.webpackChunkmeshtastic_admin_frontend||[]).push([[946],{1360:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4319:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5946:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var a=s(2555),n=s(5043),r=s(4117),o=s(4319),l=s(1861),i=s(8006);const c=(0,s(1639).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var d=s(7365),m=s(614),u=s(1360),h=s(8693),x=s(5592),g=s(3230),p=s(3986),b=s(7821),y=s(579);const f=["children","title","subtitle","headerActions","footer","className","variant","intensity","size"],j=e=>{let{children:t,title:s,subtitle:n,headerActions:r,footer:o,className:l="",variant:i="default",intensity:c="medium",size:d="md"}=e,m=(0,p.A)(e,f);return(0,y.jsxs)(b.A,(0,a.A)((0,a.A)({className:"w-full ".concat((()=>{const e={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl",full:"w-full"};return e[d]||e.md})()," ").concat(l),variant:i,intensity:c},m),{},{children:[(s||n||r)&&(0,y.jsxs)("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-white/10",children:[(0,y.jsxs)("div",{children:[s&&(0,y.jsx)("h2",{className:"text-xl font-bold text-white",children:s}),n&&(0,y.jsx)("p",{className:"text-sm text-gray-300 mt-1",children:n})]}),r&&(0,y.jsx)("div",{className:"flex items-center space-x-2",children:r})]}),(0,y.jsx)("div",{className:"flex-1",children:t}),o&&(0,y.jsx)("div",{className:"mt-6 pt-4 border-t border-white/10",children:o})]}))},v=e=>{let{className:t=""}=e;const{t:s}=(0,r.Bd)(),[p,b]=(0,n.useState)([]),[f,v]=(0,n.useState)(!1),[w,z]=(0,n.useState)(null),[N,_]=(0,n.useState)(!0),[A,k]=(0,n.useState)({name:"",description:"",center_latitude:55.7558,center_longitude:37.6176,radius_meters:100,zone_type:"safe_zone"}),[C,E]=(0,n.useState)({});(0,n.useEffect)(()=>{S()},[]);const S=async()=>{try{const e=localStorage.getItem("token"),t=await fetch("/api/zones/?limit=100&offset=0",{headers:{Authorization:e?"Bearer ".concat(e):""}});if(t.ok){const e=await t.json();b(e||[])}}catch(e){console.error("Error fetching zones:",e)}finally{_(!1)}},T=[{value:"safe_zone",label:s("zones.safe_zone"),color:"#10b981",icon:o.A},{value:"danger_zone",label:s("zones.danger_zone"),color:"#ef4444",icon:l.A},{value:"poi",label:s("zones.poi"),color:"#f59e0b",icon:i.A},{value:"restricted",label:s("zones.restricted"),color:"#8b5cf6",icon:c}],I=()=>{k({name:"",description:"",center_latitude:55.7558,center_longitude:37.6176,radius_meters:100,zone_type:"safe_zone"}),E({}),v(!1),z(null)},M=(e,t)=>{k(s=>(0,a.A)((0,a.A)({},s),{},{[e]:t})),C[e]&&E(t=>(0,a.A)((0,a.A)({},t),{},{[e]:null}))},B=async e=>{if(window.confirm(s("messages.confirm_delete")))try{await(async e=>{try{const t=localStorage.getItem("token"),s=await fetch("/api/zones/".concat(e),{method:"DELETE",headers:{Authorization:t?"Bearer ".concat(t):""}});if(s.ok)return b(t=>t.filter(t=>t.id!==e)),!0;throw console.error("Error deleting zone:",s.statusText),new Error(s.statusText)}catch(t){throw console.error("Error deleting zone:",t),t}})(e)}catch(t){console.error("Error deleting zone:",t)}};return N?(0,y.jsx)("div",{className:"space-y-6 ".concat(t),children:(0,y.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,y.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-accent-cyan"})})}):(0,y.jsxs)("div",{className:"space-y-6 ".concat(t),children:[(0,y.jsx)(j,{title:s("zones.title"),subtitle:"".concat(p.length," ").concat(s("nav.zones")),headerActions:(0,y.jsx)(x.A,{onClick:()=>v(!0),icon:(0,y.jsx)(i.A,{className:"w-4 h-4"}),children:s("zones.create")}),children:(0,y.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[p.map(e=>{const t=T.find(t=>t.value===e.zone_type),a=(null===t||void 0===t?void 0:t.icon)||i.A;return(0,y.jsx)(g.A,{title:e.name,subtitle:null===t||void 0===t?void 0:t.label,icon:(0,y.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"".concat(null===t||void 0===t?void 0:t.color,"20")},children:(0,y.jsx)(a,{className:"w-4 h-4",style:{color:null===t||void 0===t?void 0:t.color}})}),actions:(0,y.jsxs)("div",{className:"flex space-x-1",children:[(0,y.jsx)(x.A,{size:"sm",variant:"ghost",onClick:()=>(e=>{z(e),k({name:e.name,description:e.description||"",center_latitude:e.center_latitude,center_longitude:e.center_longitude,radius_meters:e.radius_meters,zone_type:e.zone_type}),v(!0)})(e),children:(0,y.jsx)(d.A,{className:"w-3 h-3"})}),(0,y.jsx)(x.A,{size:"sm",variant:"ghost",onClick:()=>B(e.id),children:(0,y.jsx)(m.A,{className:"w-3 h-3"})})]}),children:(0,y.jsxs)("div",{className:"space-y-2",children:[e.description&&(0,y.jsx)("p",{className:"text-sm text-gray-300",children:e.description}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("span",{className:"text-gray-400",children:[s("zones.center"),":"]}),(0,y.jsx)("div",{className:"text-white font-mono",children:e.center_latitude.toFixed(4)}),(0,y.jsx)("div",{className:"text-white font-mono",children:e.center_longitude.toFixed(4)})]}),(0,y.jsxs)("div",{children:[(0,y.jsxs)("span",{className:"text-gray-400",children:[s("zones.radius"),":"]}),(0,y.jsxs)("div",{className:"text-white",children:[e.radius_meters,"m"]})]})]}),(0,y.jsxs)("div",{className:"text-xs text-gray-400",children:[s("common.create"),": ",new Date(e.created_at).toLocaleDateString()]})]})},e.id)}),0===p.length&&(0,y.jsxs)("div",{className:"col-span-full text-center py-8",children:[(0,y.jsx)(i.A,{className:"w-12 h-12 text-gray-500 mx-auto mb-4"}),(0,y.jsx)("p",{className:"text-gray-400",children:s("messages.no_data")}),(0,y.jsx)(x.A,{className:"mt-4",onClick:()=>v(!0),icon:(0,y.jsx)(u.A,{className:"w-4 h-4"}),children:s("zones.create")})]})]})}),f&&(0,y.jsx)(j,{title:s(w?"zones.edit":"zones.create"),subtitle:w?"".concat(s("zones.editing")," ").concat(w.name):s("zones.create"),children:(0,y.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return A.name.trim()||(e.name=s("validation.required")),A.radius_meters<=0&&(e.radius_meters=s("validation.invalid_number")),(A.center_latitude<-90||A.center_latitude>90)&&(e.center_latitude=s("validation.latitude_range")),(A.center_longitude<-180||A.center_longitude>180)&&(e.center_longitude=s("validation.longitude_range")),E(e),0===Object.keys(e).length})())try{w?await(async(e,t)=>{try{const s=localStorage.getItem("token"),a=await fetch("/api/zones/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:s?"Bearer ".concat(s):""},body:JSON.stringify(t)});if(a.ok){const t=await a.json();return b(s=>s.map(s=>s.id===e?t:s)),t}throw console.error("Error updating zone:",a.statusText),new Error(a.statusText)}catch(s){throw console.error("Error updating zone:",s),s}})(w.id,A):await(async e=>{try{const t=localStorage.getItem("token"),s=await fetch("/api/zones/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?"Bearer ".concat(t):""},body:JSON.stringify(e)});if(s.ok){const e=await s.json();return b(t=>[...t,e]),e}throw console.error("Error creating zone:",s.statusText),new Error(s.statusText)}catch(t){throw console.error("Error creating zone:",t),t}})(A),I()}catch(t){console.error("Error saving zone:",t)}},className:"space-y-6",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[s("zones.name")," *"]}),(0,y.jsx)("input",{type:"text",value:A.name,onChange:e=>M("name",e.target.value),className:"w-full px-3 py-2 bg-white/10 border rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(C.name?"border-red-500":"border-white/20"),placeholder:s("zones.name")}),C.name&&(0,y.jsx)("p",{className:"text-red-400 text-sm mt-1",children:C.name})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:s("zones.description")}),(0,y.jsx)("textarea",{value:A.description,onChange:e=>M("description",e.target.value),rows:3,className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:s("zones.description")})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:s("zones.type")}),(0,y.jsx)("div",{className:"grid grid-cols-2 gap-2",children:T.map(e=>{const t=e.icon;return(0,y.jsx)("button",{type:"button",onClick:()=>M("zone_type",e.value),className:"p-3 rounded-lg border text-left transition-all ".concat(A.zone_type===e.value?"border-blue-500 bg-blue-500/20":"border-white/20 bg-white/5 hover:bg-white/10"),children:(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,y.jsx)(t,{className:"w-4 h-4",style:{color:e.color}}),(0,y.jsx)("span",{className:"text-sm text-white",children:e.label})]})},e.value)})})]}),(0,y.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[s("zones.center")," - ",s("zones.latitude")]}),(0,y.jsx)("input",{type:"number",step:"any",value:A.center_latitude,onChange:e=>M("center_latitude",parseFloat(e.target.value)),className:"w-full px-3 py-2 bg-white/10 border rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(C.center_latitude?"border-red-500":"border-white/20"),placeholder:"55.7558"}),C.center_latitude&&(0,y.jsx)("p",{className:"text-red-400 text-sm mt-1",children:C.center_latitude})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:s("zones.longitude")}),(0,y.jsx)("input",{type:"number",step:"any",value:A.center_longitude,onChange:e=>M("center_longitude",parseFloat(e.target.value)),className:"w-full px-3 py-2 bg-white/10 border rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(C.center_longitude?"border-red-500":"border-white/20"),placeholder:"37.6176"}),C.center_longitude&&(0,y.jsx)("p",{className:"text-red-400 text-sm mt-1",children:C.center_longitude})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsxs)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[s("zones.radius")," ",s("zones.meters")," *"]}),(0,y.jsx)("input",{type:"number",min:"1",max:"100000",value:A.radius_meters,onChange:e=>M("radius_meters",parseInt(e.target.value)),className:"w-full px-3 py-2 bg-white/10 border rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(C.radius_meters?"border-red-500":"border-white/20"),placeholder:"100"}),C.radius_meters&&(0,y.jsx)("p",{className:"text-red-400 text-sm mt-1",children:C.radius_meters})]}),(0,y.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,y.jsx)(x.A,{type:"button",variant:"ghost",onClick:I,children:s("common.cancel")}),(0,y.jsx)(x.A,{type:"submit",variant:"primary",icon:(0,y.jsx)(h.A,{className:"w-4 h-4"}),children:s(w?"common.update":"common.create")})]})]})})]})}},8693:(e,t,s)=>{s.d(t,{A:()=>a});const a=(0,s(1639).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])}}]);
//# sourceMappingURL=946.deac1e5c.chunk.js.map