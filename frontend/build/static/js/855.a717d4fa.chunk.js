/*! For license information please see 855.a717d4fa.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkmeshtastic_admin_frontend=self.webpackChunkmeshtastic_admin_frontend||[]).push([[855],{4537:(e,a,t)=>{t.d(a,{A:()=>s});const s=(0,t(1639).A)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},4939:(e,a,t)=>{t.d(a,{A:()=>s});const s=(0,t(1639).A)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},6855:(e,a,t)=>{t.r(a),t.d(a,{default:()=>w});var s=t(2555),l=t(5043),r=t(4117),i=t(6139),c=t(3230),d=t(3986),n=t(579);const o=["className","variant","animated"],x=e=>{let{className:a="",variant:t="default",animated:l=!0}=e,r=(0,d.A)(e,o);const i=l?"animate-pulse":"";return(0,n.jsx)("div",(0,s.A)((0,s.A)({className:"".concat("bg-gray-700/50 rounded"," ").concat({default:"",text:"h-4",title:"h-6",avatar:"h-10 w-10 rounded-full",button:"h-10 w-20",card:"h-32",image:"h-48 w-full"}[t]||""," ").concat(i," ").concat(a)},r),{},{"aria-hidden":"true"}))},h=e=>{let{lines:a=1,className:t=""}=e;return(0,n.jsx)("div",{className:"space-y-2 ".concat(t),children:Array.from({length:a},(e,t)=>(0,n.jsx)(x,{variant:"text",className:t===a-1&&a>1?"w-3/4":"w-full"},t))})},m=e=>{let{className:a=""}=e;return(0,n.jsxs)("div",{className:"p-6 space-y-4 ".concat(a),children:[(0,n.jsx)(x,{variant:"title",className:"w-1/2"}),(0,n.jsx)(h,{lines:3}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(x,{variant:"button"}),(0,n.jsx)(x,{variant:"button"})]})]})};var u=t(4669),b=t(1861),g=t(8006),y=t(4537),j=t(7118),v=t(4939);const _=(0,t(1639).A)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var N=t(9722);const p=()=>{const{t:e}=(0,r.Bd)(),{subscribe:a,isConnected:t}=(0,i.h3)(),[d,o]=(0,l.useState)({total_users:0,active_sessions:0,messages_today:0,bot_status:"Offline",total_alerts:0,active_zones:0,online_users:0}),[x,h]=(0,l.useState)([]),[p,w]=(0,l.useState)(!0),[f,A]=(0,l.useState)(null);(0,l.useEffect)(()=>{k(),z()},[]),(0,l.useEffect)(()=>{const t=a("statistics_update",e=>{o(a=>{var t,l;return(0,s.A)((0,s.A)((0,s.A)({},a),e.data.bot_stats),{},{total_alerts:(null===(t=e.data.alert_stats)||void 0===t?void 0:t.total_alerts)||a.total_alerts,active_zones:(null===(l=e.data.zone_stats)||void 0===l?void 0:l.active_zones)||a.active_zones})})}),l=a("new_message",a=>{o(e=>(0,s.A)((0,s.A)({},e),{},{messages_today:e.messages_today+1})),S("message","".concat(e("dashboard.new_message_from")," ").concat(a.data.user_name||e("dashboard.unknown_user")))}),r=a("new_alert",a=>{o(e=>(0,s.A)((0,s.A)({},e),{},{total_alerts:e.total_alerts+1})),S("alert","".concat(e("dashboard.new_alert")," ").concat(a.data.title))}),i=a("location_update",a=>{S("location","".concat(a.data.user_name||e("dashboard.unknown_user")," ").concat(e("dashboard.location_updated")))});return()=>{t(),l(),r(),i()}},[a]);const k=async()=>{try{A(null);const[e,a,t,s]=await Promise.all([N.A.get("/api/users/stats/overview"),N.A.get("/api/messages/stats/daily"),N.A.get("/api/alerts/stats/overview"),N.A.get("/api/zones/stats")]),l=e.data,r=a.data,i=t.data,c=s.data;o({total_users:l.total_users||0,active_sessions:l.active_sessions||0,online_users:l.online_users||0,messages_today:r.messages_today||0,bot_status:"Online",total_alerts:i.total_alerts||0,active_zones:c.active_zones||0})}catch(f){console.error("Error fetching stats:",f),A(e("dashboard.failed_load"))}finally{w(!1)}},z=async()=>{try{const e=await N.A.get("/api/audit/recent?limit=10");h(e.data.activities||[])}catch(f){console.error("Error fetching recent activity:",f)}},S=(e,a)=>{const t={id:Date.now(),type:e,description:a,timestamp:(new Date).toISOString()};h(e=>[t,...e.slice(0,9)])},M=e=>{switch(e){case"message":return(0,n.jsx)(u.A,{className:"w-4 h-4"});case"alert":return(0,n.jsx)(b.A,{className:"w-4 h-4"});case"location":return(0,n.jsx)(g.A,{className:"w-4 h-4"});default:return(0,n.jsx)(y.A,{className:"w-4 h-4"})}},C=e=>{switch(e){case"message":return"text-blue-400";case"alert":return"text-red-400";case"location":return"text-green-400";default:return"text-gray-400"}};return p?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)(m,{className:"h-8 w-48"}),(0,n.jsx)(m,{className:"h-6 w-24"})]}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Array.from({length:4},(e,a)=>(0,n.jsx)(m,{},a))}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Array.from({length:3},(e,a)=>(0,n.jsx)(m,{},a))}),(0,n.jsx)(m,{className:"h-96"})]}):f?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,n.jsxs)(c.A,{className:"text-center max-w-md",children:[(0,n.jsx)(b.A,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),(0,n.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:e("dashboard.error_loading")}),(0,n.jsx)("p",{className:"text-gray-300 mb-6",children:f}),(0,n.jsx)("button",{onClick:k,className:"px-4 py-2 bg-accent-cyan text-white rounded-lg hover:bg-accent-cyan/80 transition-colors",children:e("dashboard.try_again")})]})}):(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("header",{className:"flex justify-between items-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-white",id:"dashboard-title",children:e("dashboard.title")}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",role:"status","aria-live":"polite","aria-label":"WebSocket connection status",children:[(0,n.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(t?"bg-green-400":"bg-red-400"),"aria-hidden":"true"}),(0,n.jsx)("span",{className:"text-sm text-gray-400",children:e(t?"dashboard.live":"dashboard.disconnected")})]})]}),(0,n.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6","aria-labelledby":"stats-heading",children:[(0,n.jsx)("h2",{id:"stats-heading",className:"sr-only",children:e("dashboard.system_statistics")}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"users-stat",children:[(0,n.jsx)(j.A,{className:"w-8 h-8 text-accent-cyan mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",id:"users-stat",children:d.total_users}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.total_users")}),(0,n.jsxs)("div",{className:"text-xs text-green-400 mt-1","aria-label":"".concat(d.online_users," ").concat(e("dashboard.users_online")),children:[d.online_users," ",e("dashboard.online")]})]}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"sessions-stat",children:[(0,n.jsx)(y.A,{className:"w-8 h-8 text-accent-purple mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",id:"sessions-stat",children:d.active_sessions}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.active_sessions")})]}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"messages-stat",children:[(0,n.jsx)(u.A,{className:"w-8 h-8 text-accent-green mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",id:"messages-stat",children:d.messages_today}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.messages_today")})]}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"bot-stat",children:[(0,n.jsx)(v.A,{className:"w-8 h-8 text-accent-pink mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-2xl font-bold text-white",id:"bot-stat",children:d.bot_status}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.bot_status")})]})]}),(0,n.jsxs)("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6","aria-labelledby":"secondary-stats-heading",children:[(0,n.jsx)("h2",{id:"secondary-stats-heading",className:"sr-only",children:e("dashboard.additional_statistics")}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"alerts-stat",children:[(0,n.jsx)(b.A,{className:"w-6 h-6 text-red-400 mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-xl font-bold text-white",id:"alerts-stat",children:d.total_alerts}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.total_alerts")})]}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"zones-stat",children:[(0,n.jsx)(g.A,{className:"w-6 h-6 text-blue-400 mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-xl font-bold text-white",id:"zones-stat",children:d.active_zones}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.active_zones")})]}),(0,n.jsxs)(c.A,{className:"text-center",role:"region","aria-labelledby":"websocket-stat",children:[(0,n.jsx)(_,{className:"w-6 h-6 text-yellow-400 mx-auto mb-2","aria-hidden":"true"}),(0,n.jsx)("div",{className:"text-xl font-bold text-white",id:"websocket-stat",children:e(t?"status.connected":"status.disconnected")}),(0,n.jsx)("div",{className:"text-sm text-gray-400",children:e("dashboard.websocket_status")})]})]}),(0,n.jsx)(c.A,{title:e("dashboard.recent_activity"),role:"region","aria-labelledby":"activity-heading",children:(0,n.jsxs)("div",{className:"space-y-3 max-h-96 overflow-y-auto",role:"log","aria-live":"polite","aria-label":e("dashboard.activity_log"),children:[x.map(a=>(0,n.jsxs)("article",{className:"flex items-center space-x-3 p-3 bg-dark-800/30 rounded-lg","aria-label":"".concat(a.type," ").concat(e("dashboard.activity_label")," ").concat(a.description),children:[(0,n.jsx)("div",{className:C(a.type),"aria-hidden":"true",children:M(a.type)}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("p",{className:"text-sm text-white",children:a.description}),(0,n.jsx)("time",{className:"text-xs text-gray-400",dateTime:a.timestamp,children:new Date(a.timestamp).toLocaleTimeString()})]})]},a.id||a.timestamp)),0===x.length&&(0,n.jsx)("p",{className:"text-gray-400 text-center py-8",role:"status",children:e("dashboard.no_recent_activity")})]})})]})},w=(0,l.memo)(p)}}]);
//# sourceMappingURL=855.a717d4fa.chunk.js.map