"use strict";(self.webpackChunkmeshtastic_admin_frontend=self.webpackChunkmeshtastic_admin_frontend||[]).push([[114],{5114:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var l=t(5043),r=t(4117),a=t(3230),n=t(5592),o=t(579);const c=()=>{const{t:e}=(0,r.Bd)(),[s,t]=(0,l.useState)(null),[c,i]=(0,l.useState)(null),[d,x]=(0,l.useState)([]),[m,h]=(0,l.useState)(!0),[b,u]=(0,l.useState)("overview");(0,l.useEffect)(()=>{j();const e=setInterval(j,3e4);return()=>clearInterval(e)},[]);const j=async()=>{try{h(!0);const[e,s]=await Promise.all([fetch("/api/bot-controls/status"),fetch("/api/bot-controls/analytics/triggers")]);if(e.ok){const s=await e.json();t(s)}if(s.ok){const e=await s.json();i(e)}await f()}catch(e){console.error("Error loading bot data:",e)}finally{h(!1)}},f=async()=>{try{const e=await fetch("/api/bot-controls/analytics/triggers?limit=20");if(e.ok){const s=await e.json();x(s.recent_logs||[])}}catch(e){console.error("Error loading recent activity:",e)}},p=async function(s){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const l=await fetch("/api/bot-controls/command",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:s,parameters:t})});if(l.ok){const s=await l.json();alert("".concat(e("botControls.command_executed")," ").concat(s.message)),await j()}else alert(e("botControls.error_executing_command"))}catch(l){console.error("Error executing bot command:",l),alert(e("botControls.error_executing_command"))}},g=e=>e?"".concat((e/1e3).toFixed(2),"s"):"N/A";return m?(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-white",children:e("botControls.title")}),(0,o.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})})]}):(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-white",children:e("botControls.title")}),(0,o.jsxs)("div",{className:"flex space-x-3",children:[(0,o.jsx)(n.A,{onClick:()=>p("status_check"),className:"bg-blue-600 hover:bg-blue-700",children:e("botControls.status_check")}),(0,o.jsx)(n.A,{onClick:async()=>{try{(await fetch("/api/bot-controls/restart",{method:"POST"})).ok?alert(e("botControls.bot_restart_initiated")):alert(e("botControls.error_restarting_bot"))}catch(s){console.error("Error restarting bot:",s),alert(e("botControls.error_restarting_bot"))}},className:"bg-yellow-600 hover:bg-yellow-700",children:e("botControls.restart_bot")})]})]}),(0,o.jsx)("div",{className:"flex space-x-1 bg-dark-800 rounded-lg p-1",children:[{id:"overview",label:e("botControls.overview")},{id:"analytics",label:e("botControls.analytics")},{id:"activity",label:e("botControls.activity")},{id:"settings",label:e("botControls.settings")}].map(e=>(0,o.jsx)("button",{onClick:()=>u(e.id),className:"flex-1 px-4 py-2 rounded-md font-medium transition-colors ".concat(b===e.id?"bg-blue-600 text-white":"text-dark-300 hover:text-white hover:bg-dark-700"),children:e.label},e.id))}),"overview"===b&&(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.bot_status")}),s&&(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.status"),":"]}),(0,o.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("running"===s.status?"bg-green-900 text-green-300":"bg-red-900 text-red-300"),children:s.status||e("botControls.unknown")})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.uptime"),":"]}),(0,o.jsx)("span",{className:"text-white",children:(N=s.uptime,N&&"N/A"!==N?N:"N/A")})]}),s.stats&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.total_users"),":"]}),(0,o.jsx)("span",{className:"text-white",children:s.stats.total_users||0})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.total_messages"),":"]}),(0,o.jsx)("span",{className:"text-white",children:s.stats.total_messages||0})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.active_sessions"),":"]}),(0,o.jsx)("span",{className:"text-white",children:s.stats.active_sessions||0})]})]}),s.trigger_stats&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("hr",{className:"border-dark-600"}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.active_triggers"),":"]}),(0,o.jsx)("span",{className:"text-white",children:s.trigger_stats.active_triggers||0})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.active_responses"),":"]}),(0,o.jsx)("span",{className:"text-white",children:s.trigger_stats.active_responses||0})]})]})]})]}),(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.quick_actions")}),(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)(n.A,{onClick:()=>p("clear_cache"),className:"w-full justify-start bg-dark-700 hover:bg-dark-600",children:e("botControls.clear_cache")}),(0,o.jsx)(n.A,{onClick:()=>p("reload_config"),className:"w-full justify-start bg-dark-700 hover:bg-dark-600",children:e("botControls.reload_config")}),(0,o.jsx)(n.A,{onClick:()=>p("test_connectivity"),className:"w-full justify-start bg-dark-700 hover:bg-dark-600",children:e("botControls.test_connectivity")}),(0,o.jsx)(n.A,{onClick:()=>p("generate_report"),className:"w-full justify-start bg-dark-700 hover:bg-dark-600",children:e("botControls.generate_report")})]})]}),(0,o.jsxs)(a.A,{className:"p-6 lg:col-span-2",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white",children:e("botControls.recent_activity")}),(0,o.jsx)(n.A,{onClick:()=>u("activity"),className:"text-sm",children:e("botControls.view_all")})]}),(0,o.jsxs)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:[d.slice(0,5).map((s,t)=>(0,o.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-dark-700",children:[(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsx)("div",{className:"text-sm text-white",children:s.trigger_name||"Unknown Trigger"}),(0,o.jsxs)("div",{className:"text-xs text-dark-400",children:[s.user_name&&"".concat(e("botControls.user_label")," ").concat(s.user_name),s.execution_time_ms&&" \u2022 ".concat(g(s.execution_time_ms))]})]}),(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(s.success?"bg-green-900 text-green-300":"bg-red-900 text-red-300"),children:s.success?e("botControls.success"):e("botControls.failed")}),(0,o.jsx)("span",{className:"text-xs text-dark-400",children:new Date(s.created_at).toLocaleTimeString()})]})]},t)),0===d.length&&(0,o.jsx)("div",{className:"text-center text-dark-400 py-8",children:e("botControls.no_recent")})]})]})]}),"analytics"===b&&(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.trigger_performance")}),c&&(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-blue-400",children:c.total_executions||0}),(0,o.jsx)("div",{className:"text-sm text-dark-400",children:e("botControls.total_executions")})]}),(0,o.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-green-400",children:c.successful_executions||0}),(0,o.jsx)("div",{className:"text-sm text-dark-400",children:e("botControls.successful")})]})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.success_rate"),":"]}),(0,o.jsx)("span",{className:"text-white",children:c.total_executions>0?"".concat((c.successful_executions/c.total_executions*100).toFixed(1),"%"):"N/A"})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.avg_execution_time"),":"]}),(0,o.jsx)("span",{className:"text-white",children:g(1e3*c.average_execution_time)})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.failed_executions"),":"]}),(0,o.jsx)("span",{className:"text-red-400",children:c.failed_executions||0})]})]})]}),(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.response_performance")}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:"0"}),(0,o.jsx)("div",{className:"text-sm text-dark-400",children:e("botControls.total_deliveries")})]}),(0,o.jsxs)("div",{className:"bg-dark-800 rounded-lg p-4 text-center",children:[(0,o.jsx)("div",{className:"text-2xl font-bold text-green-400",children:"0"}),(0,o.jsx)("div",{className:"text-sm text-dark-400",children:e("botControls.successful")})]})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.avg_delivery_time"),":"]}),(0,o.jsx)("span",{className:"text-white",children:"N/A"})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsxs)("span",{className:"text-dark-300",children:[e("botControls.failed_deliveries"),":"]}),(0,o.jsx)("span",{className:"text-red-400",children:"0"})]})]})]}),(0,o.jsxs)(a.A,{className:"p-6 lg:col-span-2",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.performance_trends")}),(0,o.jsxs)("div",{className:"bg-dark-800 rounded-lg p-8 text-center",children:[(0,o.jsx)("div",{className:"text-dark-400",children:e("botControls.charts_placeholder")}),(0,o.jsx)("div",{className:"text-sm text-dark-500 mt-2",children:e("botControls.integration_needed")})]})]})]}),"activity"===b&&(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white",children:e("botControls.recent_activity")}),(0,o.jsxs)("div",{className:"flex space-x-2",children:[(0,o.jsxs)("select",{className:"bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500",children:[(0,o.jsx)("option",{value:"all",children:e("botControls.all_activities")}),(0,o.jsx)("option",{value:"trigger",children:e("botControls.triggers")}),(0,o.jsx)("option",{value:"response",children:e("botControls.responses")}),(0,o.jsx)("option",{value:"error",children:e("botControls.errors")})]}),(0,o.jsx)(n.A,{onClick:f,className:"text-sm",children:e("botControls.refresh")})]})]}),(0,o.jsxs)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[d.map((s,t)=>(0,o.jsx)("div",{className:"bg-dark-800 rounded-lg p-4 border border-dark-600",children:(0,o.jsx)("div",{className:"flex justify-between items-start",children:(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,o.jsx)("span",{className:"font-medium text-white",children:s.trigger_name||e("botControls.unknown_trigger")}),(0,o.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(s.success?"bg-green-900 text-green-300":"bg-red-900 text-red-300"),children:s.success?e("botControls.success"):e("botControls.failed")})]}),s.user_name&&(0,o.jsxs)("div",{className:"text-sm text-dark-400 mt-1",children:[e("botControls.user")," ",s.user_name]}),s.message_text&&(0,o.jsxs)("div",{className:"text-sm text-dark-400 mt-1 truncate",children:[e("botControls.message")," ",s.message_text]}),(0,o.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-dark-500",children:[(0,o.jsxs)("span",{children:[e("botControls.execution")," ",g(s.execution_time_ms)]}),(0,o.jsx)("span",{children:new Date(s.created_at).toLocaleString()})]})]})})},t)),0===d.length&&(0,o.jsx)("div",{className:"text-center text-dark-400 py-8",children:e("botControls.no_activity")})]})]}),"settings"===b&&(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.bot_configuration")}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:e("botControls.llm_provider")}),(0,o.jsxs)("select",{className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-blue-500",children:[(0,o.jsx)("option",{value:"openrouter",children:e("botControls.openrouter")}),(0,o.jsx)("option",{value:"ollama",children:e("botControls.ollama")})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:e("botControls.model")}),(0,o.jsxs)("select",{className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-blue-500",children:[(0,o.jsx)("option",{value:"gpt-5-nano",children:e("botControls.gpt5_nano")}),(0,o.jsx)("option",{value:"gemma3:latest",children:e("botControls.gemma3")})]})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-dark-300",children:e("botControls.web_search")}),(0,o.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,o.jsx)("input",{type:"checkbox",className:"sr-only peer"}),(0,o.jsx)("div",{className:"w-11 h-6 bg-dark-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-dark-300",children:e("botControls.tools_enabled")}),(0,o.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,o.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"sr-only peer"}),(0,o.jsx)("div",{className:"w-11 h-6 bg-dark-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,o.jsxs)(a.A,{className:"p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold text-white mb-4",children:e("botControls.system_settings")}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:e("botControls.default_language")}),(0,o.jsxs)("select",{className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-blue-500",children:[(0,o.jsx)("option",{value:"en",children:e("botControls.english")}),(0,o.jsx)("option",{value:"ru",children:e("botControls.russian")})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:e("botControls.max_response_length")}),(0,o.jsx)("input",{type:"number",min:"50",max:"500",defaultValue:"200",className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-blue-500"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-dark-300 mb-2",children:e("botControls.trigger_cooldown")}),(0,o.jsx)("input",{type:"number",min:"0",max:"300",defaultValue:"30",className:"w-full bg-dark-800 border border-dark-600 rounded-lg px-3 py-2 text-white focus:outline-none focus:border-blue-500"})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)("span",{className:"text-dark-300",children:e("botControls.emergency_mode")}),(0,o.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,o.jsx)("input",{type:"checkbox",className:"sr-only peer"}),(0,o.jsx)("div",{className:"w-11 h-6 bg-dark-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-600"})]})]})]})]}),(0,o.jsx)(a.A,{className:"p-6 lg:col-span-2",children:(0,o.jsxs)("div",{className:"flex justify-between items-center",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-lg font-semibold text-white",children:e("botControls.save_configuration")}),(0,o.jsx)("p",{className:"text-sm text-dark-400",children:e("botControls.restart_required")})]}),(0,o.jsx)(n.A,{className:"bg-green-600 hover:bg-green-700",children:e("botControls.save_settings")})]})})]})]});var N}}}]);
//# sourceMappingURL=114.f0366a7e.chunk.js.map